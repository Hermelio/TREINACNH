{% extends 'base.html' %}
{% load static %}

{% block extra_meta %}
<meta name="description" content="Encontre instrutores de trânsito autônomos, aulas de direção particular, instrutor credenciado e aulas práticas CNH. Compare preços, veja avaliações e agende online.">
<meta name="keywords" content="instrutor autônomo, aulas de direção particular, instrutor credenciado, aulas práticas CNH, quanto custa aula de direção, instrutor de trânsito perto de mim, aulas de carro particular, plataforma para instrutores de trânsito, instrutor de trânsito sem autoescola">
<meta property="og:title" content="Instrutor Autônomo, Aulas de Direção Particular e CNH | TreinaCNH">
<meta property="og:description" content="Encontre instrutores de trânsito autônomos, aulas de direção particular, instrutor credenciado e aulas práticas CNH. Compare preços, veja avaliações e agende online.">
<meta property="og:image" content="/static/images/og_instrutores.png">
<meta property="og:url" content="https://www.treinacnh.com.br/">
<meta name="twitter:title" content="Instrutor Autônomo, Aulas de Direção Particular e CNH | TreinaCNH">
<meta name="twitter:description" content="Encontre instrutores de trânsito autônomos, aulas de direção particular, instrutor credenciado e aulas práticas CNH. Compare preços, veja avaliações e agende online.">
<meta name="twitter:image" content="/static/images/og_instrutores.png">
<link rel="canonical" href="https://www.treinacnh.com.br/">
{% endblock %}

{% block extra_schema %}
{% if faq_schema_json %}
<script type="application/ld+json">{{ faq_schema_json|safe }}</script>
{% endif %}
{% endblock %}

{% block preload %}
<!-- Preload LCP Image - Mobile-First (≤768px usa 640w) -->
<link rel="preload" 
      as="image" 
      href="{% static 'images/hero/logohome3.1-640w.avif' %}"
      imagesrcset="{% static 'images/hero/logohome3.1-640w.avif' %} 640w,
                   {% static 'images/hero/logohome3.1-960w.avif' %} 960w"
      imagesizes="100vw"
      media="(max-width: 768px)"
      fetchpriority="high">
      
<!-- Desktop preload (≥769px usa 1280w/1920w) -->
<link rel="preload" 
      as="image" 
      href="{% static 'images/hero/logohome3.1-1280w.avif' %}"
      imagesrcset="{% static 'images/hero/logohome3.1-1280w.avif' %} 1280w,
                   {% static 'images/hero/logohome3.1-1920w.avif' %} 1920w"
      imagesizes="100vw"
      media="(min-width: 769px)"
      fetchpriority="high">
{% endblock %}

{% block extra_css %}
<!-- Leaflet CSS - lazy load (mapa está abaixo da dobra) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" media="print" onload="this.media='all'" />
<noscript><link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" /></noscript>
<style>
    /* Garantir html/body 100% */
    html, body {
        height: 100%;
        margin: 0;
    }
    
    /* Background para seções abaixo do HERO - Mobile First */
    section:not(.hero-dark) {
        background-color: #f0f2f5;
        position: relative;
        z-index: 1;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }
    
    /* Tablet e acima: backgrounds otimizados */
    @media (min-width: 768px) {
        section:not(.hero-dark) {
            background-image: url('{% static "images/backgrounds/background-site-1920w.webp" %}');
            background-attachment: scroll;
        }
        
        @supports (background-image: url('{% static "images/backgrounds/background-site-1920w.avif" %}')) {
            section:not(.hero-dark) {
                background-image: url('{% static "images/backgrounds/background-site-1920w.avif" %}');
            }
        }
    }
    
    /* Desktop: background fixo para parallax */
    @media (min-width: 1200px) {
        section:not(.hero-dark) {
            background-attachment: fixed;
        }
    }
    
    /* Hero Section - Mobile First Responsivo */
    .hero-dark {
        position: relative;
        width: 100%;
        min-height: 100vh;
        min-height: 100svh;
        background-color: #000;
        background-image: url('{% static "images/backgrounds/background-site-1920w.webp" %}');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #fff;
        display: flex;
        align-items: center;
        padding: 100px 0;
        margin: 0;
        overflow: visible;
        z-index: 2;
    }

    .hero-dark::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, 
            rgba(0,0,0,0.5) 0%, 
            rgba(0,0,0,0.5) 65%, 
            rgba(0,0,0,0) 100%);
        z-index: 1;
    }
    
    /* Tablet */
    @media (min-width: 768px) {
        .hero-dark {
            padding: 120px 0;
        }
    }
    
    /* Desktop */
    @media (min-width: 992px) {
        .hero-dark {
            height: 100vh;
            padding: 0;
        }
        .hero-dark::before {
            background: linear-gradient(to bottom, 
                rgba(0,0,0,0.45) 0%, 
                rgba(0,0,0,0.45) 70%, 
                rgba(0,0,0,0) 100%);
        }
    }
    
    /* Hero Image - Responsivo Mobile First */
    .hero-dark picture {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2;
    }
    
    .hero-dark img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
        object-position: center;
        z-index: 2;
    }
    
    /* Mobile: ajuste específico */
    @media (max-width: 576px) {
        .hero-dark img {
            object-fit: cover;
            object-position: center 30%;
        }
    }
    
    /* Tablet */
    @media (min-width: 577px) and (max-width: 991px) {
        .hero-dark img {
            object-fit: contain;
            object-position: center;
        }
    }
    
    .hero-dark .container {
        position: relative;
        z-index: 10;
    }
    
    .hero-dark .row {
        margin: 0;
    }
    
    .hero-dark > * {
        position: relative;
        z-index: 1;
    }
    
    /* Hero Content - Responsivo Completo */
    .hero-content {
        position: relative;
        z-index: 10;
        max-width: 100%;
        padding-bottom: 60px;
    }
    
    @media (min-width: 768px) {
        .hero-content {
            max-width: 600px;
            padding-bottom: 80px;
        }
    }
    
    @media (min-width: 992px) {
        .hero-content {
            padding-bottom: 140px;
        }
    }
    
    /* Tipografia Hero - Mobile First */
    .hero-dark h1 {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        color: #ffffff;
        font-size: 2rem;
        font-weight: 700;
        line-height: 1.15;
        letter-spacing: -0.02em;
        margin-bottom: 1rem;
        text-shadow: 0 2px 16px rgba(0, 0, 0, 0.5);
    }
    
    @media (min-width: 576px) {
        .hero-dark h1 {
            font-size: 2.25rem;
            line-height: 1.2;
        }
    }
    
    @media (min-width: 768px) {
        .hero-dark h1 {
            font-size: 2.75rem;
            margin-bottom: 1.25rem;
        }
    }
    
    @media (min-width: 992px) {
        .hero-dark h1 {
            font-size: 3.5rem;
            line-height: 1.1;
            letter-spacing: -0.03em;
            margin-bottom: 1.5rem;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.4);
        }
    }
    
    .hero-dark .lead {
        color: rgba(255, 255, 255, 0.85);
        font-size: 0.95rem;
        line-height: 1.6;
        margin-bottom: 1.5rem;
        max-width: 100%;
        font-weight: 400;
        text-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
    }
    
    @media (min-width: 576px) {
        .hero-dark .lead {
            font-size: 1rem;
            line-height: 1.65;
        }
    }
    
    @media (min-width: 768px) {
        .hero-dark .lead {
            font-size: 1.0625rem;
            max-width: 500px;
        }
    }
    
    @media (min-width: 992px) {
        .hero-dark .lead {
            font-size: 1.125rem;
            line-height: 1.7;
            margin-bottom: 2rem;
            text-shadow: 0 1px 10px rgba(0, 0, 0, 0.3);
        }
    }
    
    /* Badge Success Custom - Responsivo */
    .badge-success-custom {
        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        color: #ffffff;
        padding: 8px 16px;
        border-radius: 50px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 0.8125rem;
        line-height: 1;
        white-space: nowrap;
        box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        border: none;
        text-decoration: none;
    }

    .badge-success-custom i {
        font-size: 0.875rem;
        animation: pulse 2s ease-in-out infinite;
        line-height: 1;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.1); }
    }
    
    @media (min-width: 768px) {
        .badge-success-custom {
            font-size: 0.875rem;
            padding: 10px 20px;
            gap: 8px;
        }
        .badge-success-custom i {
            font-size: 0.875rem;
        }
    }
    
    /* Botões Hero Custom - Responsivo Mobile First */
    .btn-hero-custom {
        font-size: 1rem;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.625rem;
        transition: all 0.3s ease;
        text-decoration: none;
        border: none;
        width: 100%;
    }
    
    @media (min-width: 576px) {
        .btn-hero-custom {
            width: auto;
            font-size: 1.0625rem;
            padding: 0.8125rem 1.75rem;
            gap: 0.6875rem;
        }
    }
    
    @media (min-width: 768px) {
        .btn-hero-custom {
            font-size: 1.125rem;
            padding: 0.875rem 2rem;
            gap: 0.75rem;
        }
    }
    
    .btn-hero-custom:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
    
    .btn-hero-custom i {
        font-size: 1.125rem;
    }
    
    @media (min-width: 768px) {
        .btn-hero-custom i {
            font-size: 1.25rem;
        }
    }

    .btn-success-custom {
        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        border: none;
        padding: 0;
        height: 60px;
        min-width: 240px;
        font-size: 1.0625rem;
        font-weight: 600;
        border-radius: 12px;
        transition: all 0.3s ease;
        box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        position: relative;
        z-index: 50;
        margin-bottom: 120px;
        text-decoration: none;
        color: #ffffff;
        line-height: 1;
        vertical-align: middle;
    }

    .btn-success-custom i {
        font-size: 1.25rem;
        line-height: 1;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    @media (max-width: 768px) {
        .btn-success-custom {
            padding: 0;
            font-size: 0.95rem;
            height: 52px;
            min-width: 100%;
            width: 100%;
            margin-bottom: 240px;
        }
        .btn-success-custom i {
            font-size: 1.1rem;
        }
    }
    
    .btn-success-custom:hover {
        background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
        transform: translateY(-3px);
        box-shadow: 0 8px 28px rgba(34, 197, 94, 0.5);
        color: #ffffff;
    }
    
    /* Instructor Image with Badge */
    .instructor-image-wrapper {
        position: relative;
        text-align: center;
    }
    
    .instructor-image-wrapper img {
        max-width: 100%;
        height: auto;
        border-radius: 12px;
    }
    
    .new-students-badge {
        position: absolute;
        top: 20px;
        right: 20px;
        background: white;
        padding: 12px 20px;
        border-radius: 50px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .new-students-badge .avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #007bff;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
    }
    
    .new-students-badge .badge-text {
        text-align: left;
    }
    
    .new-students-badge .badge-number {
        font-size: 1.2rem;
        font-weight: 700;
        color: #1a1a1a;
    }
    
    .new-students-badge .badge-label {
        font-size: 0.85rem;
        color: #6c757d;
    }
    
    /* Stats Cards - Glass Morphism */
    .stats-card {
        background: rgba(0, 0, 0, 0.50);
        backdrop-filter: blur(14px);
        -webkit-backdrop-filter: blur(14px);
        border: 1px solid rgba(255, 255, 255, 0.10);
        padding: 28px 20px;
        border-radius: 18px;
        text-align: center;
        transition: all 0.3s ease;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 140px;
    }
    
    .stats-card .icon {
        font-size: 1.65rem;
        margin-bottom: 12px;
        color: #28a745;
    }
    
    .stats-card .number {
        font-size: 2.35rem;
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 6px;
        line-height: 1;
    }
    
    .stats-card .label {
        color: rgba(255, 255, 255, 0.82);
        font-size: 0.875rem;
        font-weight: 500;
        line-height: 1.35;
    }
    
    .stats-card:hover {
        background: rgba(0, 0, 0, 0.60);
        border-color: rgba(255, 255, 255, 0.15);
        transform: translateY(-3px);
        box-shadow: 0 8px 28px rgba(0, 0, 0, 0.35);
    }
    
    /* Stats Bar - Barra horizontal única igual ao print */
    .stats-bar {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        bottom: 24px;
        background: rgba(20, 20, 20, 0.55);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 16px;
        padding: 0 28px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0;
        width: min(1100px, calc(100% - 64px));
        height: 92px;
        min-height: 92px;
        margin: 0;
        z-index: 100;
        pointer-events: auto;
    }
    
    .stats-bar-item {
        display: flex;
        align-items: center;
        gap: 18px;
        padding: 0 24px;
        flex: 1;
        position: relative;
        height: 100%;
    }
    
    .stats-bar-item:not(:last-child)::after {
        content: '';
        position: absolute;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        height: 42px;
        width: 1px;
        background: rgba(255, 255, 255, 0.14);
    }
    
    .stats-bar-item .icon {
        font-size: 28px;
        color: #ffffff;
        flex-shrink: 0;
    }
    
    .stats-bar-item:first-child .icon {
        color: #22c55e;
    }
    
    .stats-bar-item:last-child .icon {
        color: #22c55e;
    }
    
    .stats-bar-item .content {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }
    
    .stats-bar-item .number {
        font-size: 24px;
        font-weight: 700;
        color: #ffffff;
        line-height: 1;
    }
    
    .stats-bar-item .label {
        color: rgba(255, 255, 255, 0.70);
        font-size: 13px;
        font-weight: 400;
        line-height: 1.2;
    }
    
    .stats-bar-item:last-child .number {
        font-size: 20px;
    }
    
    @media (max-width: 992px) {
        .stats-bar {
            width: calc(100% - 48px);
            height: auto;
            padding: 18px 20px;
            bottom: 16px;
            z-index: 100;
        }
        .stats-bar-item {
            padding: 0 12px;
            gap: 14px;
        }
        .stats-bar-item .number {
            font-size: 20px;
        }
        .stats-bar-item .label {
            font-size: 12px;
        }
        .btn-success-custom {
            margin-bottom: 140px;
        }
        .hero-content {
            padding-bottom: 160px;
        }
    }
    
    @media (max-width: 768px) {
        .stats-bar {
            flex-direction: column;
            padding: 14px 16px;
            gap: 0;
            min-height: 210px;
            bottom: 16px;
            width: calc(100% - 32px);
            border-radius: 12px;
        }
        .stats-bar-item {
            width: 100%;
            padding: 12px 10px;
            justify-content: flex-start;
            height: 68px;
            min-height: 68px;
        }
        .stats-bar-item:not(:last-child)::after {
            display: none;
        }
        .stats-bar-item:not(:last-child) {
            border-bottom: 1px solid rgba(255, 255, 255, 0.14);
        }
        .stats-bar-item .number {
            font-size: 20px;
        }
        .stats-bar-item .icon {
            font-size: 24px;
        }
        .stats-bar-item .label {
            font-size: 11px;
        }
    }
    
    /* Stats Cards Responsivo */
    @media (max-width: 768px) {
        .stats-card {
            min-height: 120px;
            padding: 20px 16px;
        }
        .stats-card .number {
            font-size: 2rem;
        }
        .stats-card .icon {
            font-size: 1.5rem;
        }
    }
    
    /* Feature Cards */
    .feature-card {
        background: rgba(20, 20, 20, 0.55);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 36px 28px;
        height: 100%;
        min-height: 320px;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
        display: flex;
        flex-direction: column;
    }
    
    /* Mobile: reduzir blur para melhorar performance */
    @media (max-width: 768px) {
        .feature-card,
        .benefit-card,
        .stats-bar {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
    }
    
    .feature-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 16px 45px rgba(0, 0, 0, 0.45);
        border-color: rgba(255, 255, 255, 0.12);
    }
    
    .feature-card h3 {
        font-family: 'Inter', system-ui, sans-serif;
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 12px;
        color: #ffffff;
        line-height: 1.4;
    }
    
    .feature-card p {
        color: rgba(255, 255, 255, 0.70);
        line-height: 1.6;
        margin: 0;
        font-size: 0.95rem;
    }
    
    /* Setas de fluxo entre os cards */
    .feature-cards-container {
        position: relative;
        overflow: visible;
    }
    
    .feature-cards-container .col-md-4 {
        position: relative;
    }
    
    .feature-cards-container .col-md-4:nth-child(1)::after,
    .feature-cards-container .col-md-4:nth-child(2)::after {
        content: '';
        position: absolute;
        right: -24px;
        top: 50%;
        transform: translateY(-50%);
        width: 40px;
        height: 40px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2322c55e' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='5' y1='12' x2='19' y2='12'%3E%3C/line%3E%3Cpolyline points='12 5 19 12 12 19'%3E%3C/polyline%3E%3C/svg%3E");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        z-index: 10;
        pointer-events: none;
    }
    
    @media (max-width: 992px) {
        .feature-cards-container .col-md-4:nth-child(1)::after,
        .feature-cards-container .col-md-4:nth-child(2)::after {
            display: none;
        }
    }
    
    .feature-icon {
        width: 64px;
        height: 64px;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
        font-size: 1.75rem;
        flex-shrink: 0;
    }
    
    .feature-icon.green {
        background: rgba(34, 197, 94, 0.15);
        color: #22c55e;
    }
    
    .feature-icon.blue {
        background: rgba(34, 197, 94, 0.15);
        color: #22c55e;
    }
    
    .feature-icon.orange {
        background: rgba(34, 197, 94, 0.15);
        color: #22c55e;
    }
    
    .feature-card h3 {
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 12px;
        color: #ffffff;
    }
    
    .feature-card p {
        color: rgba(255, 255, 255, 0.70);
        line-height: 1.6;
        margin: 0;
    }
    
    /* Benefits Section */
    .benefit-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 36px 28px;
        height: 100%;
        min-height: 320px;
        transition: all 0.3s ease;
        border: 1px solid rgba(0, 0, 0, 0.06);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
        display: flex;
        flex-direction: column;
    }
    
    .benefit-card:hover {
        background: white;
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
        transform: translateY(-6px);
        border-color: rgba(0, 0, 0, 0.08);
    }
    
    .benefit-card h4 {
        font-family: 'Inter', system-ui, sans-serif;
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 12px;
        color: #1a1a1a;
        line-height: 1.4;
    }
    
    .benefit-card p {
        color: rgba(0, 0, 0, 0.65);
        line-height: 1.6;
        margin: 0;
        font-size: 0.95rem;
    }
    
    .benefit-icon {
        width: 64px;
        height: 64px;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
        font-size: 1.75rem;
        flex-shrink: 0;
    }
    
    .benefit-icon.green {
        background: rgba(40, 167, 69, 0.15);
        color: #28a745;
    }
    
    .benefit-icon.blue {
        background: rgba(0, 123, 255, 0.15);
        color: #007bff;
    }
    
    .benefit-icon.purple {
        background: rgba(111, 66, 193, 0.15);
        color: #6f42c1;
    }
    
    .benefit-card h4 {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 12px;
        color: #1a1a1a;
    }
    
    .benefit-card p {
        color: #6c757d;
        line-height: 1.6;
        margin: 0;
    }
    
    /* Section Titles */
    .section-title {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        font-size: clamp(1.75rem, 3.5vw, 2.5rem);
        font-weight: 600;
        color: #ffffff;
        line-height: 1.25;
        letter-spacing: -0.02em;
        margin-bottom: 1rem;
        text-align: left;
    }
    
    /* Mapa */
    #homeMap {
        height: 650px;
        width: 100%;
        min-height: 650px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        background: rgba(20, 20, 20, 0.3);
    }
    
    .state-info-tooltip {
        background: white;
        padding: 10px;
        border-radius: 4px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        border: 2px solid #0d6efd;
    }
    
    .state-info-tooltip h6 {
        margin: 0 0 5px 0;
        color: #0d6efd;
        font-weight: bold;
    }
    
    .state-info-tooltip p {
        margin: 0;
        font-size: 13px;
    }
    
    @media (max-width: 991px) {
        .hero-dark h1 {
            font-size: 2.5rem;
        }
        
        .section-title {
            font-size: 2rem;
        }
    }
    
    @media (max-width: 767px) {
        .hero-dark h1 {
            font-size: 2rem;
        }
        
        .stats-card .number {
            font-size: 2rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            text-align: center;
        }
        
        .lead {
            text-align: center;
            font-size: 0.9rem !important;
            margin-left: auto;
            margin-right: auto;
        }
        
        .feature-card {
            min-height: auto;
            padding: 28px 24px;
        }
        
        .feature-card h3 {
            font-size: 1.1rem;
        }
        
        .feature-card p {
            font-size: 0.9rem;
        }
        
        .feature-icon {
            width: 56px;
            height: 56px;
            font-size: 1.5rem;
        }
        
        #homeMap {
            height: 400px;
            min-height: 400px;
        }
    }
        height: 64px;
        border-radius: 12px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2rem;
        margin-bottom: 20px;
    }
    
    .suggestion-icon.bg-success {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }
    
    .suggestion-icon.bg-info {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    
    /* Large Image Sections */
    .large-image-wrapper {
        text-align: center;
        padding: 40px;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border-radius: 24px;
    }
    
    .hero-image-wrapper {
        text-align: center;
        padding: 40px;
    }
    
    /* Bootstrap Carousel Customization */
    #instructorsCarousel .carousel-item {
        transition: transform 0.6s ease-in-out;
    }
    
    .instructor-carousel-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        height: 100%;
    }
    
    .instructor-carousel-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    
    .instructor-carousel-img {
        width: 100%;
        height: 280px;
        object-fit: cover;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .instructor-carousel-img.no-photo {
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 80px;
    }
    
    .instructor-badge-verified {
        position: absolute;
        top: 16px;
        right: 16px;
        background: #198754;
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 500;
        box-shadow: 0 2px 8px rgba(25, 135, 84, 0.3);
    }
    
    .carousel-control-prev,
    .carousel-control-next {
        width: 50px;
        height: 50px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 50%;
        top: 50%;
        transform: translateY(-50%);
        opacity: 0.8;
    }
    
    .carousel-control-prev:hover,
    .carousel-control-next:hover {
        background: rgba(0, 0, 0, 0.8);
        opacity: 1;
    }
    
    .carousel-indicators [data-bs-target] {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: #0d6efd;
    }
    
    /* Floating Stat Bubble - estilo tooltip saindo do rosto */
    .stat-bubble {
        position: absolute;
        top: 25%;
        right: 38%;
        width: 280px;
        height: 68px;
        background: #ffffff;
        border-radius: 50px;
        padding: 12px 20px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        z-index: 150;
        display: flex;
        align-items: center;
        gap: 12px;
        animation: floatBubble 3s ease-in-out infinite;
        will-change: transform;
    }
    
    @keyframes floatBubble {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-6px); }
    }
    
    /* Tail/pontinha apontando para o rosto - lado direito inferior */
    .stat-bubble::after {
        content: '';
        position: absolute;
        right: -6px;
        bottom: 35%;
        transform: rotate(45deg);
        width: 18px;
        height: 18px;
        background: #ffffff;
        box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.08);
        z-index: -1;
        border-radius: 2px;
    }
    
    .stat-bubble:hover {
        box-shadow: 0 10px 32px rgba(0, 0, 0, 0.15);
    }
    
    .stat-bubble .avatar-ring {
        width: 44px;
        height: 44px;
        background: linear-gradient(135deg, #28a745, #20c997);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #ffffff;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.25);
        flex-shrink: 0;
    }
    
    .stat-bubble .avatar-ring i {
        font-size: 20px;
        color: #ffffff;
    }
    
    .stat-bubble .bubble-content {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }
    
    .stat-bubble .bubble-number {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1a1a1a;
        line-height: 1;
    }
    
    .stat-bubble .bubble-label {
        font-size: 0.7rem;
        color: #6c757d;
        font-weight: 500;
        line-height: 1.2;
        white-space: nowrap;
    }
    
    /* Responsivo - reposicionar bubble */
    @media (max-width: 1200px) {
        .stat-bubble {
            top: 24%;
            right: 34%;
            padding: 10px 16px;
            gap: 10px;
        }
        .stat-bubble::after {
            right: -5px;
            bottom: 33%;
            width: 16px;
            height: 16px;
        }
        .stat-bubble .avatar-ring {
            width: 38px;
            height: 38px;
        }
        .stat-bubble .bubble-number {
            font-size: 1.3rem;
        }
        .stat-bubble .bubble-label {
            font-size: 0.65rem;
        }
    }
    
    @media (max-width: 992px) {
        .stat-bubble {
            top: 22%;
            right: 30%;
            padding: 8px 14px;
            gap: 8px;
        }
        .stat-bubble::after {
            right: -4px;
            bottom: 30%;
            width: 14px;
            height: 14px;
        }
        .stat-bubble .avatar-ring {
            width: 34px;
            height: 34px;
        }
        .stat-bubble .avatar-ring i {
            font-size: 16px;
        }
        .stat-bubble .bubble-number {
            font-size: 1.15rem;
        }
    }
    
    @media (max-width: 768px) {
        .stat-bubble {
            display: none;
        }
    }

    /* Seção 2 - Transição contínua sem faixa preta */
    .section-overlap {
        position: relative;
        z-index: 1;
        margin-top: -180px;
        padding-top: 180px;
    }

    @media (max-width: 768px) {
        .section-overlap {
            margin-top: -120px;
            padding-top: 120px;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- TESTE_HERO_2026_01_24 -->
<!-- Hero Section com Background Image - Estilo Uber -->
<section class="hero-dark">
    <!-- Hero Image - Mobile-First Structure -->
    <picture>
        <!-- MOBILE: AVIF 640w-960w -->
        <source type="image/avif"
                media="(max-width: 768px)"
                srcset="{% static 'images/hero/logohome3.1-640w.avif' %} 640w,
                        {% static 'images/hero/logohome3.1-960w.avif' %} 960w"
                sizes="100vw">
        
        <!-- DESKTOP: AVIF 1280w-1920w -->
        <source type="image/avif"
                media="(min-width: 769px)"
                srcset="{% static 'images/hero/logohome3.1-1280w.avif' %} 1280w,
                        {% static 'images/hero/logohome3.1-1920w.avif' %} 1920w"
                sizes="(min-width: 1920px) 1920px, 100vw">
        
        <!-- MOBILE: WebP fallback -->
        <source type="image/webp"
                media="(max-width: 768px)"
                srcset="{% static 'images/hero/logohome3.1-640w.webp' %} 640w,
                        {% static 'images/hero/logohome3.1-960w.webp' %} 960w"
                sizes="100vw">
        
        <!-- DESKTOP: WebP fallback -->
        <source type="image/webp"
                media="(min-width: 769px)"
                srcset="{% static 'images/hero/logohome3.1-1280w.webp' %} 1280w,
                        {% static 'images/hero/logohome3.1-1920w.webp' %} 1920w"
                sizes="(min-width: 1920px) 1920px, 100vw">
        
        <!-- Fallback PNG (mobile-first) -->
        <img src="{% static 'images/hero/logohome3.1-640w.png' %}"
             alt="TreinaCNH - Plataforma para Instrutores de Direção"
             width="1920"
             height="1280"
             style="aspect-ratio: 3/2"
             fetchpriority="high"
             loading="eager"
             decoding="async">
    </picture>
    
    <!-- Floating Stat Bubble - tooltip saindo do rosto -->
    <div class="stat-bubble">
        <div class="avatar-ring">
            <i class="bi bi-graph-up-arrow"></i>
        </div>
        <div class="bubble-content">
            <div class="bubble-number">+75</div>
            <div class="bubble-label">Novos alunos hoje</div>
        </div>
    </div>
    
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-7 col-xl-6 hero-content">
                <div class="badge-success-custom mb-3">
                    <i class="bi bi-star-fill"></i> Oportunidade para instrutores
                </div>
                
                <h1>Centenas de alunos<br>aguardando por você,<br>instrutor.</h1>
                
                <p class="lead">
                    Cadastre-se agora mesmo e comece a dar aulas na sua região. Alta demanda em todo o Brasil.
                </p>
                
                <div style="margin-bottom: 120px;">
                    <a href="{% url 'accounts:register' %}" class="btn btn-success btn-lg btn-hero-custom shadow-lg">
                        <i class="bi bi-person-badge-fill"></i>
                        <span>Cadastre-se como Instrutor</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Stats Bar - Barra horizontal única no fundo do hero -->
    <div class="stats-bar">
        <div class="stats-bar-item">
            <div class="icon">
                <i class="bi bi-people-fill"></i>
            </div>
            <div class="content">
                <div class="number">{{ total_students }}</div>
                <div class="label">Alunos aguardando</div>
            </div>
        </div>
        <div class="stats-bar-item">
            <div class="icon">
                <i class="bi bi-geo-alt-fill"></i>
            </div>
            <div class="content">
                <div class="number">{{ top_student_states.0.total }}</div>
                <div class="label">Alunos em Sao Paulo</div>
            </div>
        </div>
        <div class="stats-bar-item">
            <div class="icon">
                <i class="bi bi-check-circle-fill"></i>
            </div>
            <div class="content">
                <div class="number" style="font-size: 1.5rem;">Grátis</div>
            </div>
        </div>
    </div>
</section>

<!-- Comparação: Cenário Atual vs TreinaCNH -->
<section class="py-5" style="padding-top: 4rem !important; padding-bottom: 4rem !important;">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="section-title mb-3" style="font-size: 2.25rem;">
                <i class="bi bi-arrow-left-right me-2"></i>Por que mudar para a TreinaCNH?
            </h2>
            <p class="lead" style="color: rgba(255, 255, 255, 0.70); max-width: 700px; margin: 0 auto; font-size: 1.125rem;">
                Compare e veja como você ganha mais liberdade e rendimento
            </p>
        </div>

        <div class="row g-4">
            <!-- Lado Esquerdo: Cenário Atual (Vermelho) -->
            <div class="col-lg-6">
                <div style="background: linear-gradient(135deg, rgba(220, 53, 69, 0.15) 0%, rgba(185, 28, 28, 0.15) 100%); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 2px solid rgba(220, 53, 69, 0.4); border-radius: 24px; padding: 40px 32px; height: 100%; box-shadow: 0 12px 30px rgba(220, 53, 69, 0.2);">
                    
                    <!-- Header -->
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px; padding-bottom: 24px; border-bottom: 2px solid rgba(220, 53, 69, 0.3);">
                        <div style="background: linear-gradient(135deg, #dc3545 0%, #b91c1c 100%); width: 64px; height: 64px; border-radius: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(220, 53, 69, 0.4);">
                            <i class="bi bi-x-circle-fill" style="font-size: 2rem; color: #ffffff;"></i>
                        </div>
                        <div>
                            <h3 style="font-family: 'Inter', sans-serif; font-size: 1.75rem; font-weight: 700; color: #ffffff; margin: 0; line-height: 1.2;">
                                Cenário Atual
                            </h3>
                            <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.95rem; margin: 0;">
                                Como as coisas são hoje
                            </p>
                        </div>
                    </div>

                    <!-- Lista de problemas -->
                    <div style="display: flex; flex-direction: column; gap: 20px;">
                        <div style="display: flex; align-items: start; gap: 14px;">
                            <i class="bi bi-x-lg" style="color: #dc3545; font-size: 1.25rem; margin-top: 2px; flex-shrink: 0;"></i>
                            <div>
                                <p style="color: #ffffff; font-size: 1.0625rem; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                    Horários fixos
                                </p>
                                <p style="color: rgba(255, 255, 255, 0.65); font-size: 0.9375rem; margin: 0; line-height: 1.5;">
                                    Sem flexibilidade para organizar seu dia
                                </p>
                            </div>
                        </div>

                        <div style="display: flex; align-items: start; gap: 14px;">
                            <i class="bi bi-x-lg" style="color: #dc3545; font-size: 1.25rem; margin-top: 2px; flex-shrink: 0;"></i>
                            <div>
                                <p style="color: #ffffff; font-size: 1.0625rem; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                    Parte do valor da aula vai para a auto-escola
                                </p>
                                <p style="color: rgba(255, 255, 255, 0.65); font-size: 0.9375rem; margin: 0; line-height: 1.5;">
                                    Você trabalha, mas não fica com tudo
                                </p>
                            </div>
                        </div>

                        <div style="display: flex; align-items: start; gap: 14px;">
                            <i class="bi bi-x-lg" style="color: #dc3545; font-size: 1.25rem; margin-top: 2px; flex-shrink: 0;"></i>
                            <div>
                                <p style="color: #ffffff; font-size: 1.0625rem; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                    Sem liberdade para ser você mesmo
                                </p>
                                <p style="color: rgba(255, 255, 255, 0.65); font-size: 0.9375rem; margin: 0; line-height: 1.5;">
                                    Regras rígidas limitam seu potencial
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lado Direito: Com a TreinaCNH (Azul/Verde) -->
            <div class="col-lg-6">
                <div style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(16, 185, 129, 0.15) 100%); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 2px solid rgba(34, 197, 94, 0.4); border-radius: 24px; padding: 40px 32px; height: 100%; box-shadow: 0 12px 30px rgba(34, 197, 94, 0.25); position: relative; overflow: hidden;">
                    
                    <!-- Decorative glow -->
                    <div style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: radial-gradient(circle, rgba(34, 197, 94, 0.15) 0%, transparent 70%); border-radius: 50%; pointer-events: none;"></div>
                    
                    <!-- Header -->
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px; padding-bottom: 24px; border-bottom: 2px solid rgba(34, 197, 94, 0.3); position: relative;">
                        <div style="background: linear-gradient(135deg, #22c55e 0%, #10b981 100%); width: 64px; height: 64px; border-radius: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(34, 197, 94, 0.5);">
                            <i class="bi bi-check-circle-fill" style="font-size: 2rem; color: #ffffff;"></i>
                        </div>
                        <div>
                            <h3 style="font-family: 'Inter', sans-serif; font-size: 1.75rem; font-weight: 700; color: #ffffff; margin: 0; line-height: 1.2;">
                                Com a TreinaCNH
                            </h3>
                            <p style="color: rgba(255, 255, 255, 0.85); font-size: 0.95rem; margin: 0; font-weight: 500;">
                                Liberdade e mais dinheiro
                            </p>
                        </div>
                    </div>

                    <!-- Lista de benefícios -->
                    <div style="display: flex; flex-direction: column; gap: 20px; position: relative;">
                        <div style="display: flex; align-items: start; gap: 14px;">
                            <i class="bi bi-check-lg" style="color: #22c55e; font-size: 1.5rem; margin-top: 0; flex-shrink: 0; font-weight: 700;"></i>
                            <div>
                                <p style="color: #ffffff; font-size: 1.0625rem; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                    Horários flexíveis
                                </p>
                                <p style="color: rgba(255, 255, 255, 0.75); font-size: 0.9375rem; margin: 0; line-height: 1.5;">
                                    Você define quando e onde trabalhar
                                </p>
                            </div>
                        </div>

                        <div style="display: flex; align-items: start; gap: 14px;">
                            <i class="bi bi-check-lg" style="color: #22c55e; font-size: 1.5rem; margin-top: 0; flex-shrink: 0; font-weight: 700;"></i>
                            <div>
                                <p style="color: #ffffff; font-size: 1.0625rem; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                    100% do valor da aula para você
                                </p>
                                <p style="color: rgba(255, 255, 255, 0.75); font-size: 0.9375rem; margin: 0; line-height: 1.5;">
                                    Todo o seu trabalho fica com você
                                </p>
                            </div>
                        </div>

                        <div style="display: flex; align-items: start; gap: 14px;">
                            <i class="bi bi-check-lg" style="color: #22c55e; font-size: 1.5rem; margin-top: 0; flex-shrink: 0; font-weight: 700;"></i>
                            <div>
                                <p style="color: #ffffff; font-size: 1.0625rem; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                    Mais liberdade para escolher como quer trabalhar
                                </p>
                                <p style="color: rgba(255, 255, 255, 0.75); font-size: 0.9375rem; margin: 0; line-height: 1.5;">
                                    Seu jeito, suas regras, seu sucesso
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Call to action footer -->
                    <div style="margin-top: 32px; padding-top: 24px; border-top: 2px solid rgba(34, 197, 94, 0.3); position: relative;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <i class="bi bi-rocket-takeoff-fill" style="color: #22c55e; font-size: 1.5rem;"></i>
                            <p style="color: #ffffff; font-size: 1.125rem; font-weight: 700; margin: 0; line-height: 1.3;">
                                Você se torna um Ser Humano mais dono de si,<br>
                                <span style="background: linear-gradient(135deg, #22c55e 0%, #10b981 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">usando a tecnologia a seu favor!</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CTA Button -->
        <div class="text-center mt-5">
            <a href="{% url 'accounts:register' %}" class="btn btn-success btn-lg btn-hero-custom shadow-lg" style="font-size: 1.25rem; padding: 1rem 3rem;">
                <i class="bi bi-star-fill"></i>
                <span>Quero Essa Liberdade Agora!</span>
            </a>
            <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.95rem; margin-top: 16px; margin-bottom: 0;">
                <i class="bi bi-shield-check me-1"></i>Cadastro grátis • Sem taxas escondidas • Cancele quando quiser
            </p>
        </div>
    </div>
</section>

<!-- Como Funciona -->
<section class="py-5 section-overlap" style="padding-bottom: 5rem !important;">
    <div class="container">
        <h2 class="section-title mb-4">Treinar com a TreinaCNH é fácil:</h2>
        <p class="lead" style="color: rgba(255, 255, 255, 0.70); max-width: 600px; margin-bottom: 3rem; font-size: 1rem; line-height: 1.6; font-weight: 400;">Comece a dar aulas em três passos simples</p>
        
        <div class="row g-4 feature-cards-container position-relative">
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon green">
                        <i class="bi bi-person-plus-fill"></i>
                    </div>
                    <h3>Registre-se como instrutor</h3>
                    <p>Cadastre-se grátis e crie seu perfil em poucos minutos.</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon blue">
                        <i class="bi bi-chat-dots-fill"></i>
                    </div>
                    <h3>Receba solicitações de alunos</h3>
                    <p>Aceite solicitações de alunos na sua região, diretamente pelo nosso app.</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon orange">
                        <i class="bi bi-cash-coin"></i>
                    </div>
                    <h3>Comece a dar aulas e ganhe</h3>
                    <p>Marque as aulas, treine os alunos e receba pagamentos direto na sua conta.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Seção para Alunos -->
<section class="py-5" style="padding-top: 4rem !important; padding-bottom: 5rem !important;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(16, 185, 129, 0.15) 100%); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 24px; padding: 48px; box-shadow: 0 20px 60px rgba(34, 197, 94, 0.2); position: relative; overflow: hidden;">
                    
                    <!-- Decorative elements -->
                    <div style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: radial-gradient(circle, rgba(34, 197, 94, 0.2) 0%, transparent 70%); border-radius: 50%;"></div>
                    <div style="position: absolute; bottom: -30px; left: -30px; width: 150px; height: 150px; background: radial-gradient(circle, rgba(16, 185, 129, 0.15) 0%, transparent 70%); border-radius: 50%;"></div>
                    
                    <div class="row align-items-center" style="position: relative; z-index: 1;">
                        <div class="col-md-8 mb-4 mb-md-0">
                            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 20px;">
                                <div style="background: #22c55e; width: 64px; height: 64px; border-radius: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(34, 197, 94, 0.4);">
                                    <i class="bi bi-mortarboard-fill" style="font-size: 2rem; color: #ffffff;"></i>
                                </div>
                                <div>
                                    <h2 style="font-family: 'Inter', sans-serif; font-size: 2rem; font-weight: 700; color: #ffffff; margin: 0; line-height: 1.2;">
                                        Você é aluno?
                                    </h2>
                                    <p style="color: rgba(255, 255, 255, 0.85); font-size: 1.1rem; margin: 0; font-weight: 500;">
                                        Encontre o instrutor ideal para você!
                                    </p>
                                </div>
                            </div>
                            
                            <p style="color: rgba(255, 255, 255, 0.75); font-size: 1rem; line-height: 1.7; margin-bottom: 24px; max-width: 600px;">
                                Conecte-se com instrutores verificados na sua região, compare preços e avaliações, 
                                e agende suas aulas de forma rápida e segura.
                            </p>
                            
                            <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <i class="bi bi-check-circle-fill" style="color: #22c55e; font-size: 1.2rem;"></i>
                                    <span style="color: rgba(255, 255, 255, 0.85); font-size: 0.95rem;">Instrutores verificados</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <i class="bi bi-check-circle-fill" style="color: #22c55e; font-size: 1.2rem;"></i>
                                    <span style="color: rgba(255, 255, 255, 0.85); font-size: 0.95rem;">Preços transparentes</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <i class="bi bi-check-circle-fill" style="color: #22c55e; font-size: 1.2rem;"></i>
                                    <span style="color: rgba(255, 255, 255, 0.85); font-size: 0.95rem;">Avaliações reais</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4 text-center text-md-end">
                            <a href="{% url 'marketplace:student_register' %}" class="btn btn-success btn-lg btn-hero-custom shadow-lg">
                                <i class="bi bi-person-check-fill"></i>
                                <span>Cadastrar como Aluno</span>
                            </a>
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.85rem; margin-top: 12px; margin-bottom: 0;">
                                <i class="bi bi-shield-check me-1"></i>100% gratuito e sem compromisso
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Mapa Interativo -->
<section class="py-5" style="padding-top: 5rem !important; padding-bottom: 5rem !important;">
    <div class="container py-4">
        <div class="text-center mb-5">
            <h2 class="section-title mb-4" style="text-align: center;"><i class="bi bi-map me-2"></i>Veja Onde Estão os Alunos</h2>
            <p class="lead" style="color: rgba(255, 255, 255, 0.70); max-width: 700px; margin-left: auto; margin-right: auto; font-size: 1rem; line-height: 1.6; font-weight: 400; text-align: center;">Descubra a demanda por instrutores em todo o Brasil</p>
        </div>
        
        <div style="background: rgba(20, 20, 20, 0.55); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 20px; padding: 24px; box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);">
            <div style="border-radius: 16px; overflow: hidden;">
                <div id="homeMap"></div>
            </div>
            <div style="padding: 20px 16px; background: rgba(0, 0, 0, 0.2); border-radius: 0 0 16px 16px; margin-top: -4px;">
                <div class="row text-center">
                    <div class="col-md-6 mb-3 mb-md-0">
                        <div class="d-flex align-items-center justify-content-center">
                            <div style="width: 24px; height: 24px; background: #22c55e; border: 2px solid rgba(255, 255, 255, 0.6); border-radius: 50%; flex-shrink: 0;"></div>
                            <div class="text-start ms-2">
                                <small class="d-block" style="color: rgba(255, 255, 255, 0.90); font-weight: 600;">Alunos por Cidade</small>
                                <small class="d-block" style="color: rgba(255, 255, 255, 0.60); font-size: 0.75rem;">Tamanho = quantidade de alunos</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-center justify-content-center">
                            <div style="width: 24px; height: 24px; background: #dc3545; border: 2px solid rgba(255, 255, 255, 0.6); border-radius: 50%; flex-shrink: 0; display: flex; align-items: center; justify-content: center;">
                                <i class="bi bi-person-fill" style="color: white; font-size: 0.7rem;"></i>
                            </div>
                            <small class="ms-2" style="color: rgba(255, 255, 255, 0.90); font-weight: 600;">Instrutores Cadastrados</small>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-3">
                    <small style="color: rgba(255, 255, 255, 0.70);"><i class="bi bi-cursor me-1"></i>Clique nos marcadores verdes para ver detalhes dos alunos em cada cidade</small>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Final -->
<section class="py-5" style="padding-top: 5rem !important; padding-bottom: 3rem !important;">
    <div class="container text-center py-5">
        <h2 class="section-title mb-4" style="text-align: center;">Pronto para começar?</h2>
        <p class="lead mb-4" style="color: rgba(255, 255, 255, 0.70); max-width: 700px; margin-left: auto; margin-right: auto; font-size: 1rem; line-height: 1.6; font-weight: 400; text-align: center;">Cadastre-se gratuitamente e comece a dar aulas hoje mesmo!</p>
        
        <!-- Bonus Badge -->
        <div style="display: inline-block; background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); border-radius: 50px; padding: 12px 28px; margin-bottom: 20px; box-shadow: 0 4px 16px rgba(255, 152, 0, 0.4); animation: pulse-glow 2s ease-in-out infinite;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <i class="bi bi-lightning-charge-fill" style="font-size: 1.5rem; color: #fff; animation: flash 1.5s ease-in-out infinite;"></i>
                <span style="font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 600; color: #1a1a1a;">
                    🎉 Instrutores Pioneiros: <strong>14 dias grátis!</strong>
                </span>
            </div>
        </div>
        
        <div>
            <a href="{% url 'accounts:register' %}" class="btn btn-success btn-lg btn-hero-custom shadow-lg">
                <i class="bi bi-star-fill"></i>
                <span>Criar Conta Grátis</span>
            </a>
        </div>
    </div>
</section>

<style>
@keyframes pulse-glow {
    0%, 100% {
        box-shadow: 0 4px 16px rgba(255, 152, 0, 0.4);
        transform: scale(1);
    }
    50% {
        box-shadow: 0 4px 24px rgba(255, 152, 0, 0.6);
        transform: scale(1.02);
    }
}

@keyframes flash {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
// Lazy load Leaflet and Markercluster when map enters viewport
const mapObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            // Load Leaflet first
            const leafletCSS = document.createElement('link');
            leafletCSS.rel = 'stylesheet';
            leafletCSS.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';
            document.head.appendChild(leafletCSS);
            
            // Load Markercluster CSS
            const clusterCSS = document.createElement('link');
            clusterCSS.rel = 'stylesheet';
            clusterCSS.href = 'https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css';
            document.head.appendChild(clusterCSS);
            
            const clusterDefaultCSS = document.createElement('link');
            clusterDefaultCSS.rel = 'stylesheet';
            clusterDefaultCSS.href = 'https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css';
            document.head.appendChild(clusterDefaultCSS);
            
            const leafletScript = document.createElement('script');
            leafletScript.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
            leafletScript.onload = function() {
                // Load Markercluster after Leaflet
                const clusterScript = document.createElement('script');
                clusterScript.src = 'https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js';
                clusterScript.onload = initMap;
                document.head.appendChild(clusterScript);
            };
            document.head.appendChild(leafletScript);
            mapObserver.disconnect();
        }
    });
}, { rootMargin: '100px' });

const mapElement = document.getElementById('homeMap');
if (mapElement) {
    mapObserver.observe(mapElement);
}

function initMap() {
    console.log('Initializing professional map with city-level precision...');
    
    // Brazil bounds
    const brazilBounds = [
        [-33.75, -73.99], // Southwest
        [5.27, -34.79]    // Northeast
    ];
    
    // Initialize map
    const map = L.map('homeMap', {
        center: [-14.235, -51.925],
        zoom: 4,
        minZoom: 4,
        maxZoom: 18,
        maxBounds: brazilBounds,
        maxBoundsViscosity: 1.0
    });
    
    // Add tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors',
        maxZoom: 19
    }).addTo(map);
    
    // Show loading indicator
    const loadingDiv = document.createElement('div');
    loadingDiv.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 1000;';
    loadingDiv.innerHTML = '<i class="bi bi-hourglass-split"></i> Carregando cidades...';
    mapElement.appendChild(loadingDiv);
    
    // Check user type from Django context
    const isInstructor = {{ is_instructor|yesno:"true,false" }};
    const isAuthenticated = {{ user_authenticated|yesno:"true,false" }};
    
    // Fetch city data from API
    fetch('/instrutores/api/map/cities/')
        .then(response => response.json())
        .then(data => {
            console.log('Cities loaded:', data.stats);
            loadingDiv.remove();
            
            // Create marker cluster group
            const markers = L.markerClusterGroup({
                maxClusterRadius: 80,
                spiderfyOnMaxZoom: true,
                showCoverageOnHover: false,
                zoomToBoundsOnClick: true,
                iconCreateFunction: function(cluster) {
                    const childCount = cluster.getChildCount();
                    let size = 'small';
                    if (childCount > 20) size = 'large';
                    else if (childCount > 10) size = 'medium';
                    
                    return L.divIcon({
                        html: '<div><span>' + childCount + '</span></div>',
                        className: 'marker-cluster marker-cluster-' + size,
                        iconSize: L.point(40, 40)
                    });
                }
            });
            
            // Add city markers
            data.cities.forEach(function(cityData) {
                // Calculate radius based on student count (logarithmic scale)
                const radius = Math.max(6, Math.min(26, 6 + Math.log(cityData.count + 1) * 4));
                
                const marker = L.circleMarker([cityData.lat, cityData.lng], {
                    radius: radius,
                    fillColor: '#22c55e',
                    color: '#fff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.8
                });
                
                // Get category counts
                const catA = cityData.categories.A || 0;
                const catB = cityData.categories.B || 0;
                
                // Popup content depends on user type
                let popupContent;
                
                if (isAuthenticated) {
                    // Logged in users (instructor or student): show stats only, no action
                    if (isInstructor) {
                        // Instructor: protected message
                        popupContent = `
                            <div class="text-center" style="min-width: 220px;">
                                <h6 class="mb-2" style="color: #22c55e; font-weight: 700; font-size: 1.1rem;">
                                    <i class="bi bi-people-fill me-1"></i>${cityData.count} ${cityData.count === 1 ? 'Aluno' : 'Alunos'}
                                </h6>
                                <p class="mb-2" style="font-size: 0.95rem; color: #333; font-weight: 600;">
                                    <i class="bi bi-geo-alt-fill me-1" style="color: #22c55e;"></i>${cityData.city} - ${cityData.uf}
                                </p>
                                <hr style="margin: 12px 0; border-color: rgba(34, 197, 94, 0.3);">
                                <div style="background: #fff3cd; padding: 12px; border-radius: 8px; border-left: 4px solid #ffc107;">
                                    <p class="mb-0 small" style="color: #856404;">
                                        <i class="bi bi-shield-lock-fill me-1"></i>
                                        <strong>Dados protegidos.</strong><br>
                                        Os alunos entrarão em contato diretamente com você através do seu perfil.
                                    </p>
                                </div>
                            </div>
                        `;
                    } else {
                        // Student logged in: show stats only
                        popupContent = `
                            <div class="text-center" style="min-width: 220px;">
                                <h6 class="mb-2" style="color: #22c55e; font-weight: 700; font-size: 1.1rem;">
                                    <i class="bi bi-people-fill me-1"></i>${cityData.count} ${cityData.count === 1 ? 'Aluno' : 'Alunos'}
                                </h6>
                                <p class="mb-2" style="font-size: 0.95rem; color: #333; font-weight: 600;">
                                    <i class="bi bi-geo-alt-fill me-1" style="color: #22c55e;"></i>${cityData.city} - ${cityData.uf}
                                </p>
                                <hr style="margin: 12px 0; border-color: rgba(34, 197, 94, 0.3);">
                                <div style="background: #f8f9fa; padding: 10px; border-radius: 8px;">
                                    <p class="mb-1 small" style="color: #555;">
                                        <i class="bi bi-award-fill me-1" style="color: #22c55e;"></i>Cat. A: <strong>${catA}</strong> | Cat. B: <strong>${catB}</strong>
                                    </p>
                                    <p class="mb-0 small" style="color: #555;">
                                        <i class="bi bi-journal-check me-1" style="color: #0d6efd;"></i>Com teoria: <strong>${cityData.with_theory}</strong>
                                    </p>
                                </div>
                            </div>
                        `;
                    }
                } else {
                    // Not logged in: show stats and registration button
                    popupContent = `
                        <div class="text-center" style="min-width: 220px;">
                            <h6 class="mb-2" style="color: #22c55e; font-weight: 700; font-size: 1.1rem;">
                                <i class="bi bi-people-fill me-1"></i>${cityData.count} ${cityData.count === 1 ? 'Aluno' : 'Alunos'}
                            </h6>
                            <p class="mb-2" style="font-size: 0.95rem; color: #333; font-weight: 600;">
                                <i class="bi bi-geo-alt-fill me-1" style="color: #22c55e;"></i>${cityData.city} - ${cityData.uf}
                            </p>
                            <hr style="margin: 12px 0; border-color: rgba(34, 197, 94, 0.3);">
                            <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 12px;">
                                <p class="mb-1 small" style="color: #555;">
                                    <i class="bi bi-award-fill me-1" style="color: #22c55e;"></i>Cat. A: <strong>${catA}</strong> | Cat. B: <strong>${catB}</strong>
                                </p>
                                <p class="mb-0 small" style="color: #555;">
                                    <i class="bi bi-journal-check me-1" style="color: #0d6efd;"></i>Com teoria: <strong>${cityData.with_theory}</strong>
                                </p>
                            </div>
                            <a href="/contas/registrar/" class="btn btn-sm btn-success" style="width: 100%; font-weight: 600;">
                                <i class="bi bi-rocket-takeoff-fill me-1"></i>Cadastrar e Atender
                            </a>
                        </div>
                    `;
                }
                
                marker.bindPopup(popupContent);
                
                // Tooltip - simple for instructors, detailed for others
                let tooltipContent;
                
                if (isInstructor) {
                    // Instructor: minimal info
                    tooltipContent = `
                        <div style="text-align: center; padding: 8px;">
                            <strong style="font-size: 1rem; color: #1a1a1a;">${cityData.city}</strong><br>
                            <span style="color: #22c55e; font-weight: 700; font-size: 1.1rem;">
                                <i class="bi bi-people-fill"></i> ${cityData.count} aluno${cityData.count > 1 ? 's' : ''}
                            </span>
                            <div style="margin-top: 8px; font-size: 0.8rem; color: #666;">
                                <i class="bi bi-shield-lock-fill"></i> Dados protegidos
                            </div>
                        </div>
                    `;
                } else if (isAuthenticated) {
                    // Student logged in: show stats
                    tooltipContent = `
                        <div style="text-align: center; padding: 8px;">
                            <strong style="font-size: 1rem; color: #1a1a1a;">${cityData.city}</strong><br>
                            <span style="color: #22c55e; font-weight: 700; font-size: 1.1rem;">
                                <i class="bi bi-people-fill"></i> ${cityData.count} aluno${cityData.count > 1 ? 's' : ''}
                            </span>
                            <hr style="margin: 8px 0; border-color: rgba(34, 197, 94, 0.3);">
                            <div style="font-size: 0.85rem; color: #555;">
                                <div style="margin: 4px 0;">
                                    <i class="bi bi-award-fill me-1" style="color: #22c55e;"></i>
                                    A: <strong>${catA}</strong> | B: <strong>${catB}</strong>
                                </div>
                                <div style="margin: 4px 0;">
                                    <i class="bi bi-journal-check me-1" style="color: #0d6efd;"></i>
                                    Teoria: <strong>${cityData.with_theory}</strong>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Not logged in: detailed info
                    tooltipContent = `
                        <div style="text-align: center; padding: 8px;">
                            <strong style="font-size: 1rem; color: #1a1a1a;">${cityData.city}</strong><br>
                            <span style="color: #22c55e; font-weight: 700; font-size: 1.1rem;">
                                <i class="bi bi-people-fill"></i> ${cityData.count} aluno${cityData.count > 1 ? 's' : ''}
                            </span>
                            <hr style="margin: 8px 0; border-color: rgba(34, 197, 94, 0.3);">
                            <div style="font-size: 0.85rem; color: #555;">
                                <div style="margin: 4px 0;">
                                    <i class="bi bi-award-fill me-1" style="color: #22c55e;"></i>
                                    A: <strong>${catA}</strong> | B: <strong>${catB}</strong>
                                </div>
                                <div style="margin: 4px 0;">
                                    <i class="bi bi-journal-check me-1" style="color: #0d6efd;"></i>
                                    Teoria: <strong>${cityData.with_theory}</strong>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                marker.bindTooltip(tooltipContent, {
                    permanent: false,
                    direction: 'top',
                    className: 'custom-tooltip',
                    offset: [0, -10]
                });
                
                // Hover effects
                marker.on('mouseover', function() {
                    this.setStyle({ fillOpacity: 1, radius: radius * 1.2, weight: 3 });
                });
                marker.on('mouseout', function() {
                    this.setStyle({ fillOpacity: 0.8, radius: radius, weight: 2 });
                });
                
                markers.addLayer(marker);
            });
            
            // Add markers to map
            map.addLayer(markers);
            
            // Show stats in console
            console.log('📊 Map Statistics:', data.stats);
            if (data.stats.cities_without_coords > 0) {
                console.warn(`⚠️ ${data.stats.cities_without_coords} cities without coordinates`);
            }
            
        })
        .catch(error => {
            console.error('Error loading map data:', error);
            loadingDiv.innerHTML = '<i class="bi bi-exclamation-triangle"></i> Erro ao carregar dados';
        });
    
    // Fetch and add instructor markers (legacy data)
    const instructorsData = {{ instructors_json|safe }};
    instructorsData.forEach(function(instructor) {
        if (instructor.latitude && instructor.longitude) {
            const instructorMarker = L.marker([instructor.latitude, instructor.longitude], {
                icon: L.divIcon({
                    className: 'custom-instructor-marker',
                    html: '<div style="background-color: #dc3545; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"><i class="bi bi-person-fill"></i></div>',
                    iconSize: [24, 24]
                })
            }).addTo(map);
            
            const instructorName = `${instructor.user__first_name} ${instructor.user__last_name}`;
            const cityName = instructor.city__name;
            const stateName = instructor.city__state__name;
            
            instructorMarker.bindPopup(`
                <div class="text-center">
                    <h6 class="mb-2">${instructorName}</h6>
                    <p class="mb-1 small"><i class="bi bi-geo-alt-fill me-1"></i>${cityName} - ${stateName}</p>
                    <a href="/instrutores/instrutor/${instructor.id}/" class="btn btn-sm btn-primary mt-2">
                        Ver Perfil
                    </a>
                </div>
            `);
        }
    });
    
    // Add custom CSS
    const style = document.createElement('style');
    style.textContent = `
        .custom-tooltip {
            background: white !important;
            border: 2px solid #22c55e !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2) !important;
            padding: 0 !important;
            min-width: 200px;
        }
        .custom-tooltip::before {
            border-top-color: #22c55e !important;
        }
        .leaflet-tooltip-top::before {
            border-top-color: #22c55e !important;
        }
        .leaflet-popup-content-wrapper {
            border-radius: 8px;
        }
        .custom-instructor-marker {
            background: transparent !important;
            border: none !important;
        }
        .marker-cluster {
            background-color: rgba(34, 197, 94, 0.6);
            border-radius: 50%;
        }
        .marker-cluster div {
            background-color: rgba(34, 197, 94, 0.8);
            color: white;
            font-weight: 700;
            text-align: center;
            border-radius: 50%;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .marker-cluster-small div {
            background-color: rgba(34, 197, 94, 0.7);
        }
        .marker-cluster-medium div {
            background-color: rgba(34, 197, 94, 0.8);
        }
        .marker-cluster-large div {
            background-color: rgba(16, 185, 129, 0.9);
        }
    `;
    document.head.appendChild(style);
}
</script>
{% endblock %}







