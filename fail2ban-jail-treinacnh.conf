# Fail2ban jail configuration for TREINACNH
# Place this in /etc/fail2ban/jail.d/treinacnh.conf

[DEFAULT]
# Ban duration (in seconds) - 1 hour
bantime = 3600

# Time window to count failures (in seconds) - 10 minutes
findtime = 600

# Max number of failures before ban
maxretry = 5

# Email notifications (optional)
# destemail = admin@treinacnh.com.br
# sender = fail2ban@treinacnh.com.br
# action = %(action_mwl)s

[sshd]
enabled = true
port = ssh
logpath = /var/log/auth.log
maxretry = 3
bantime = 7200

[nginx-http-auth]
enabled = true
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 5

[nginx-noscript]
enabled = true
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 6

[nginx-badbots]
enabled = true
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2

[nginx-noproxy]
enabled = true
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2

[django-auth]
enabled = true
port = http,https
filter = django-auth
logpath = /var/www/TREINACNH/logs/django.log
          /var/www/TREINACNH/logs/gunicorn-error.log
maxretry = 5
findtime = 600
bantime = 3600

[nginx-limit-req]
enabled = true
port = http,https
filter = nginx-limit-req
logpath = /var/log/nginx/error.log
maxretry = 10
findtime = 60
bantime = 600
